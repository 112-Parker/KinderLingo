
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KinderLingo</title>
    <style>
        :root { --primary: #2563eb; --secondary: #10b981; --bg: #f1f5f9; --danger: #ef4444; --dark: #1e293b; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--bg); color: var(--dark); }
        
        /* Login */
        #login-page { display: flex; align-items: center; justify-content: center; height: 100vh; background: var(--dark); }
        .login-box { background: white; padding: 30px; border-radius: 12px; width: 320px; text-align: center; }

        /* Header */
        #main-app { display: none; min-height: 100vh; flex-direction: column; }
        header { background: white; padding: 10px 5%; display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #e2e8f0; sticky; top: 0; z-index: 100; }
        .logo-area { display: flex; align-items: center; gap: 10px; font-weight: bold; font-size: 20px; color: var(--primary); }
        .logo-box { width: 40px; height: 40px; background: var(--primary); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; }
        
        .search-bar { flex: 0 1 400px; }
        .search-bar input { width: 100%; padding: 10px 15px; border-radius: 20px; border: 1px solid #cbd5e1; outline: none; }

        /* Content */
        .container { display: flex; max-width: 1200px; margin: 20px auto; width: 95%; gap: 20px; }
        .sidebar { width: 250px; background: white; border-radius: 12px; padding: 15px; height: fit-content; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .menu-item { padding: 12px 15px; margin-bottom: 8px; cursor: pointer; border-radius: 8px; transition: 0.3s; }
        .menu-item.active { background: #eff6ff; color: var(--primary); font-weight: bold; }

        .main-content { flex: 1; background: white; border-radius: 12px; padding: 30px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .card { border: 1px solid #e2e8f0; padding: 15px; border-radius: 12px; margin-bottom: 20px; }
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; margin: 10px 0; border-radius: 8px; overflow: hidden; background: #000; }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        
        .btn { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }
        .btn-primary { background: var(--primary); color: white; }
        
        input, select { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        .pdf-btn { display: inline-block; background: #fef3c7; color: #92400e; padding: 10px 20px; border-radius: 6px; text-decoration: none; font-weight: bold; margin-top: 10px; }
    </style>
</head>
<body>

<div id="login-page">
    <div class="login-box">
        <div class="logo-box" style="margin: 0 auto 15px; width: 60px; height: 60px; font-size: 30px;">K</div>
        <h2>Log in</h2>
        <input type="text" id="username" placeholder="admin">
        <input type="password" id="password" placeholder="123">
        <button class="btn btn-primary" style="width:100%" onclick="login()">Learn</button>
    </div>
</div>

<div id="main-app">
    <header>
        <div class="logo-area"><div class="logo-box">K</div> KinderLingo</div>
        <div class="search-bar"><input type="text" id="searchInput" placeholder="Searching leson..." onkeyup="searchContent()"></div>
        <button class="btn" style="background:#f1f5f9; color: var(--danger)" onclick="location.reload()">Exit</button>
    </header>

    <div class="container">
        <div class="sidebar">
            <div class="menu-item active" onclick="openTab(event, 'view-content')">üìñ Lessons</div>
            <div class="menu-item" onclick="openTab(event, 'admin-panel')">‚öôÔ∏è Administration</div>
        </div>

        <div class="main-content">
            <div id="view-content" class="tab-panel active">
                <div id="content-list"></div>
            </div>

            <div id="admin-panel" class="tab-panel">
                <h3>New content</h3>
                <div style="background:#f8fafc; padding: 20px; border-radius: 10px;">
                    <label>Content type:</label>
                    <select id="contentType" onchange="toggleInput()">
                        <option value="video">Video file</option>
                        <option value="pdf">PDF</option>
                    </select>
                    <input type="text" id="contentTitle" placeholder="Lesson title...">
                    <input type="text" id="contentLink" placeholder="Video link...">
                    <input type="file" id="contentFile" accept="application/pdf" style="display:none">
                    <button class="btn btn-primary" style="background:var(--secondary); width:100%" onclick="saveContent()">Save</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // 1. LOGIN & TAB
    function login() {
        if (document.getElementById('username').value === 'admin' && document.getElementById('password').value === '123') {
            document.getElementById('login-page').style.display = 'none';
            document.getElementById('main-app').style.display = 'flex';
            displayContent();
        } else alert("Wrong!");
    }

    function openTab(evt, tabName) {
        document.querySelectorAll(".tab-panel").forEach(p => p.classList.remove("active"));
        document.querySelectorAll(".menu-item").forEach(i => i.classList.remove("active"));
        document.getElementById(tabName).classList.add("active");
        evt.currentTarget.classList.add("active");
    }

    function toggleInput() {
        const isPDF = document.getElementById('contentType').value === 'pdf';
        document.getElementById('contentLink').style.display = isPDF ? 'none' : 'block';
        document.getElementById('contentFile').style.display = isPDF ? 'block' : 'none';
    }

    // 2. FILE TO BASE64
    const toBase64 = file => new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result);
        reader.onerror = error => reject(error);
    });

    // 3. L∆ØU & HI·ªÇN TH·ªä
    async function saveContent() {
        const type = document.getElementById('contentType').value;
        const title = document.getElementById('contentTitle').value;
        let data = "";

        if (!title) return alert("Enter title!");

        if (type === 'video') {
            const link = document.getElementById('contentLink').value;
            data = link.split('v=')[1]?.split('&')[0] || link.split('/').pop();
        } else {
            const file = document.getElementById('contentFile').files[0];
            if (!file) return alert("Choosing file please!");
            if (file.size > 2 * 1024 * 1024) return alert("The file needs to be <2 MB!");
            data = await toBase64(file);
        }

        const library = JSON.parse(localStorage.getItem('myEduLib')) || [];
        library.push({ id: Date.now(), type, title, data });
        localStorage.setItem('myEduLib', JSON.stringify(library));
        
        alert("Done!");
        displayContent();
        document.getElementById('admin-panel').classList.remove('active');
        document.getElementById('view-content').classList.add('active');
    }

    function displayContent(search = "") {
    const list = document.getElementById('content-list');
    const library = JSON.parse(localStorage.getItem('myEduLib')) || [];
    const filtered = library.filter(i => i.title.toLowerCase().includes(search.toLowerCase()));

    list.innerHTML = "";
    filtered.forEach(item => {
        const card = document.createElement('div');
        card.className = 'card';
        let content = `<div style="display:flex; justify-content:space-between">
            <strong>${item.title} ${item.type === 'pdf' ? '<span style="font-size:10px; color:orange">[PDF]</span>' : ''}</strong>
            <button onclick="removeItem(${item.id})" style="color:red; border:none; background:none; cursor:pointer">Delete</button>
        </div>`;
        
        if (item.type === 'video') {
            content += `<div class="video-container"><iframe src="https://www.youtube.com/embed/${item.data}"></iframe></div>`;
        } else {
            // S·ª¨A ·ªû ƒê√ÇY: D√πng function viewPDF thay v√¨ th·∫ª <a> tr·ª±c ti·∫øp
            content += `<button onclick="viewPDF('${item.id}')" class="pdf-btn" style="border:none; cursor:pointer">üìñ Open PDF File</button>`;
        }
        card.innerHTML = content;
        list.prepend(card);
    });
}

// TH√äM H√ÄM M·ªöI N√ÄY V√ÄO TRONG TH·∫∫ <script>
function viewPDF(id) {
    const library = JSON.parse(localStorage.getItem('myEduLib')) || [];
    const item = library.find(i => i.id == id);
    
    if (item && item.data) {
        // T·∫°o m·ªôt Blob t·ª´ Base64 ƒë·ªÉ tr√¨nh duy·ªát d·ªÖ ƒë·ªçc h∆°n
        const base64Data = item.data.split(',')[1];
        const byteCharacters = atob(base64Data);
        const byteNumbers = new Array(byteCharacters.length);
        for (let i = 0; i < byteCharacters.length; i++) {
            byteNumbers[i] = byteCharacters.charCodeAt(i);
        }
        const byteArray = new Uint8Array(byteNumbers);
        const blob = new Blob([byteArray], {type: 'application/pdf'});
        
        // T·∫°o URL t·∫°m th·ªùi v√† m·ªü n√≥
        const fileURL = URL.createObjectURL(blob);
        window.open(fileURL, '_blank');
    } else {
        alert("File not found!");
    }
}

    function searchContent() { displayContent(document.getElementById('searchInput').value); }

    function removeItem(id) {
        if (confirm("Delete this?")) {
            let lib = JSON.parse(localStorage.getItem('myEduLib')).filter(i => i.id !== id);
            localStorage.setItem('myEduLib', JSON.stringify(lib));
            displayContent();
        }
    }
</script>
</body>
</html>